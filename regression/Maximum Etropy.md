# 最大熵模型（Maximum Etropy）

最大熵模型由最大熵原理推导实现，而最大熵原理是概率模型学习的一个准则：学习概率模型时，在所有可能的概率模型（分布）中，熵最大的模型是最好的模型。



## 熵

假设离散随机变量$X$的概率分布是$p(X)$，则其熵为：$H(X)=-\sum_x p(X)logp(X)$

熵满足下列不等式$0<=H(X)<=log|X|$，其中$|X|$为变量个数，即当一个变量$X$服从均匀分布时，它所包含的信息熵是最大的。

**重点：**

1. 熵是随机变量不确定性的度量，不确定性越大，熵越大；若随机变量退化为定值，则熵最小，为0；若随机变量为均匀分布，熵最大。

   ​



## 联合熵和条件熵

假设两个离散的随机变量$X,Y$的联合分布为$p(X,Y)$，则其联合熵为：$H(X,Y)=-\sum_{x,y}p(X,Y)logp(X,Y)$

条件熵$H(X|Y)$表示$(X,Y)$发生所包含的熵减去$Y$单独发生所包含的条件熵，即在$Y$

发生的前提下，X发生带来的熵。即：

$H(X|Y) = H(X,Y)-H(Y)$

$=-\sum_{x,y}p(X,Y)log p(X,Y)+\sum_yp(Y)log p(Y)$

$=-\sum_{x,y}p(X,Y)logp(X,Y)+\sum_y(\sum_xp(X,Y))logp(Y)$

$=-\sum_{x,y}p(X,Y)logp(X,Y)+\sum_{x,y}p(X,Y)logp(Y)$

$=-\sum_{x,y}p(X,Y)log\frac{p(X,Y)}{p(Y)}$

$=-\sum_{x,y}p(X,Y)logp(x|y)$



## 相对熵/交叉熵/K-L散度

假设$p(X)$和$q(X)$是变量X的两个概率分布，则$p$对$q$的相对熵是：$D(p||q)=\sum_xp(x)log\frac{p(x)}{q(x)}$。

**重点：**

1. 相对熵可以度量两个随机变量之间的距离；
2. 一般不具有对称性，即$D(p||q) != D(q||p)$，当且仅当$p=q$，则相对熵为0，二者相等；
3. $D(p||q) >=0, D(q||p)>=0$。

假定已知随机变量$p$，求一个随机变量$q$，使得$q$尽量接近于$p$，这样我们可以使用P和Q的K-L来度量他们的距离。

- 假定使用$D(q||p)$，为了让距离最小，则要求$p$为0的地方，$q$尽量为0。这样会得到比较瘦高的分布曲线；
- 假定使用$D(p || q)$，为了让距离最小，则要求$p$不为0 的地方，$q$也尽量不为0。这样会得到比较矮胖的分布曲线。

## 互信息

两个随机变量$X、Y$的互信息，定义为$X、Y$的联合分布和独立分布乘积的相对熵。即：

$I(X,Y)=\sum_{x,y}p(x,y)log\frac{p(x,y)}{p(x)p(y)}$

**重点：**

$H(X|Y)=H(X)-I(X,Y)$

互信息为0，则随机变量$X$和$Y$是互相独立的。



## 各种熵之间的关系

$H(X|Y) = H(X,Y)-H(Y)$；$H(Y|X) = H(X,Y)-H(X)$

$H(X|Y)=H(X)-I(X,Y)$；$H(Y|X)=H(Y)-I(X,Y)$

$I(X,Y)=H(X)+H(Y)-H(X,Y)$



## 最大熵模型

最大熵模型的原则：

- 承认已知事物（知识）；
- 对未知事物不做任何假设、没有任何偏见。

对一个随机事件的概率分布进行预测时，我们的预测应当满足全部已知条件，而对未知的情况不做任何主观假设。在这种情况下，概率分布最均匀，预测的风险最小。

因为这时概率分布的信息熵最大，所以人们把这种模型叫做“最大熵模型”。

最大熵模型一般是在给定条件下条件熵，所以常用拉格朗日乘子法来解决。

模型的求解可以[参考这篇博客](http://blog.csdn.net/itplus/article/details/26550201)

**重点：**

1. 比较:

   - logistic/softmax回归的后验概率形式：

     logistic:   $h(c=1|x;\theta)=\frac{1}{1+e^{-\theta^Tx}};h(c=1|x;\theta)=\frac{e^{-\theta^Tx}}{1+e^{-\theta^Tx}}$

     softmax: $h(c=k|x;\theta)=\frac{e^{\theta x}}{\sum_{j=1}^Ke^{\theta x}},k=1,...,K$

   - 最大熵模型的后验概率形式：

     $p_\lambda(y|x)=\frac{1}{Z_\lambda(x)}exp(\sum_i\lambda _if_i(x,y))$


2. logistic回归模型与最大熵模型都是属于对数线性模型；

3. 逻辑回归与最大熵模型没有本质区别。逻辑回归是最大熵对应类别为二类时的特殊情况

4. 指数族分布的最大熵等价于指数形式的最大似然

   二项分布的最大熵等价于二项式分布的指数形式（sigmod）的最大似然

   多项式分布的最大熵等价于多项式分布的指数形式（softmax）的最大似然
